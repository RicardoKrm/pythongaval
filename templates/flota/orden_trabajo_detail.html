{% extends "flota/base.html" %}

{% block title %}Detalle OT #{{ ot.folio }}{% endblock %}

{% block extra_head %}
<!-- Estilos que SÓLO se aplican a esta página y no romperán el resto del sitio -->
<style>
.grid-container { display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; }
@media (max-width: 992px) { .grid-container { grid-template-columns: 1fr; } }
.ot-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem; }
.ot-status { padding: .25rem .75rem; border-radius: 9999px; font-weight: bold; color: white; }
.status-PENDIENTE { background-color: #dd6b20; }
.status-EN_PROCESO { background-color: #3182ce; }
.status-CERRADA_MECANICO { background-color: #718096; }
.status-FINALIZADA { background-color: #2f855a; }
.data-list { list-style: none; padding: 0; }
.data-list li { display: flex; justify-content: space-between; align-items: center; padding: .75rem 0; border-bottom: 1px solid #4a5568; }
.data-list li:last-child { border-bottom: none; }
.data-list strong { color: #a0aec0; }
.assigned-personnel-list { list-style: none; padding: 0; }
.assigned-personnel-list li { padding: 0.5rem; border-radius: 4px; background-color: #1a202c; margin-bottom: 0.5rem; }
.assigned-personnel-list .badge-responsable { background-color: #f6ad55; color: #1a202c; padding: 2px 6px; border-radius: 4px; font-size: 0.75em; font-weight: bold; margin-right: 8px; }
.card h4 i { font-size: 0.9em; color: #a0aec0; }
.action-accordion .card { background-color: transparent; border: none; margin-bottom: 0.5rem; }
.action-accordion .card-header { padding: 0; border: none; }
.action-accordion .card-header button { width: 100%; background-color: #2d3748; color: #e2e8f0; text-align: left; padding: 1rem 1.5rem; border: 1px solid #4a5568; border-radius: 8px; font-weight: 600; text-decoration: none; display: flex; justify-content: space-between; align-items: center; }
.action-accordion .card-header button:hover, .action-accordion .card-header button:focus { background-color: #4a5568; outline: none; }
.action-accordion .card-header button.collapsed::after { content: '\f078'; font-family: 'Font Awesome 5 Free'; font-weight: 900; }
.action-accordion .card-header button:not(.collapsed)::after { content: '\f077'; font-family: 'Font Awesome 5 Free'; font-weight: 900; }
.action-accordion .card-body { background-color: #2d3748; padding: 1.5rem; border: 1px solid #4a5568; border-top: none; border-radius: 0 0 8px 8px; }
.action-accordion form p { margin-bottom: 1rem; }
.action-accordion form label { font-weight: 600; font-size: 0.9em; }
.action-accordion .btn-submit { width: 100%; }
</style>
{% endblock %}

{% block content %}
<div class="ot-header">
    <div>
        <h1>Orden de Trabajo <span class="text-muted">#{{ ot.folio }}</span></h1>
        <p class="h4">{{ ot.vehiculo }}</p>
    </div>
    <span class="ot-status status-{{ ot.estado }}">{{ ot.get_estado_display }}</span>
</div>

<div class="grid-container">
    <!-- Columna Izquierda -->
    <div class="left-column">
        <!-- ... contenido de la columna izquierda (Información, Tareas, Insumos) ... -->
    </div>
    <!-- Columna Derecha -->
    <div class="right-column">
        <div class="accordion action-accordion" id="accordionOT">
            <!-- Acordeón para Añadir Tarea -->
            <div class="card">
                <div class="card-header" id="headingTarea">
                    <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseTarea" aria-expanded="false" aria-controls="collapseTarea">Añadir Tarea</button>
                </div>
                <div id="collapseTarea" class="collapse" aria-labelledby="headingTarea" data-parent="#accordionOT">
                    <div class="card-body"><form method="post">{% csrf_token %}{{ manual_tarea_form.as_p }}<button type="submit" name="add_manual_tarea" class="btn-submit">Añadir Tarea</button></form></div>
                </div>
            </div>
            <!-- ... resto de los paneles del acordeón ... -->
        </div>
    </div>
</div>
{% endblock %}